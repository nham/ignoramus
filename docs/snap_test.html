<!doctype html>
<html>
    <head>
        <title>aaa</title>
    <script src="snap.svg-min.js"></script>
    </head>
<body>
    <svg id="svg" width="600" height="600" style="border: 1px solid #333"></svg>
    <script src="diffdraw.js"></script>
    <script>

var s = Snap("#svg");
var black = "#222";


// start is an object {x: <canvas pos>, y: <canvas pos>}
// rows/cols are numbers
var grid = function(start, rows, cols, diags) {
    diags = diags || [];

    var line_start = {x: start.x - 0.5, y: start.y - 0.5};

    var lines_grid = draw_grid_lines(s, line_start, rows, cols);

    var diag_lines =  [];
    for (var i = 0; i < diags.length; i++) {
        diag_lines.push(
            draw_diag_line(s, line_start, {x: diags[i][0], y: diags[i][1]},
                                  {x: diags[i][0]+1, y: diags[i][1]+1})
        );
    }

    draw_grid_dots(s, start, rows, cols);
    var fill_stroke = {fill: "#ff6d1f", stroke: "#ff2d1f"};

    var make_callback = function(n) {
        if(n === diag_lines.length) {
            return make_terminal_callback(n);
        } else {
            return make_non_terminal_callback(n);
        }
    };

    var delay = 600;

    var make_non_terminal_callback = function(n) {
        return function() {
            diag_lines[n].animate(fill_stroke, delay, null,
                                  make_callback(n+1));
        };
    };

    var make_terminal_callback = function(n) {
        return function() {
            diag_lines[n].animate(fill_stroke, delay);
        };
    };

    make_callback(0)();

};

var grid_start = {x: 29.5, y: 29.5};
grid(grid_start, 10, 9, [[1, 2], [3, 1], [4, 4], [0, 3], [6, 7], [8, 3]]);
    </script>
</body>
</html>
